# Analysis: gpu: nova-core: avoid probing non-display/compute PCI functions

**Generated**: 2025-08-27 17:04:38
**Series ID**: 991254
**Author**: John Hubbard
**Date**: 2025-08-13
**Patches**: 1
**Patchwork URL**: https://patchwork.kernel.org/project/rust-for-linux/list/?series=991254

---

# Executive Brief: gpu: nova-core: avoid probing non-display/compute PCI functions

**Status**: Quality concerns  
**Significance**: Bug fix

## What & Why
This patch prevents the nova-core GPU driver from attempting to probe PCI functions that aren't GPU-related (display/compute), avoiding crashes when the driver tries to access hardware resources that don't exist on those functions. The patch addresses kernel crashes and NULL pointer dereferences occurring during driver initialization on multi-function GPU devices.

## Technical Context
Nova-core appears to be a Rust GPU driver in development that handles NVIDIA GPU devices. Modern GPU cards often expose multiple PCI functions - typically function 0 for display/compute and additional functions for audio, USB controllers, or other auxiliary features. The driver was incorrectly attempting to probe all functions, leading to resource mapping failures when trying to access GPU-specific BARs (Base Address Registers) on non-GPU functions. This is a common pattern in GPU drivers where PCI function filtering is essential to avoid hardware access errors.

## Issues & Conflicts
The patch reveals underlying issues in the Rust kernel infrastructure. Danilo Krummrich (a key Rust-for-Linux maintainer) identified that the crashes are actually caused by a bug in the Devres (device resource management) system, which he has already fixed in a separate patch. This suggests the nova-core driver is exposing edge cases in Rust kernel abstractions that need to be resolved before broader GPU driver adoption. The incomplete email thread truncation prevents full assessment of the resolution status.